targetPackage: zhy2002.examples.register
typeName: Register
rootType:
  typeName: RegisterNode
  baseTypeName: RootUiNode

  properties:
  - {name: hasError, typeName: Boolean, default: Boolean.FALSE}

  children:
  - {typeName: UsernameNode}
  - {typeName: EmailNode}
  - {typeName: PasswordNode}
  - {typeName: RepeatPasswordNode}
  - {typeName: AgeNode}
  - {typeName: PlanNode}
  - {typeName: ReceiveOffersNode}
  - {typeName: OwnInvestmentPropertyNode}
  - {typeName: PropertyDetailsNode, name: residentialPropertyNode}
  - typeName: PropertyDetailsNode
    name: investmentPropertyNode
    init:
    - {propertyName: loadWithParent, value: 'false'}
  - {typeName: PhoneInfoNode, name: homePhoneNode}
  - {typeName: ErrorListNode}

  rules:
  - {typeName: SetHasErrorRule, existing: false}
  - {typeName: MergeValidationErrorsRule, existing: true}

  childTypes:
  - typeName: UsernameNode
    baseTypeName: StringUiNode
    init:
    - {propertyName: minLength, value: 4}
    - {propertyName: invalidChars, value: "\"#\""}
    - {propertyName: lengthMessage, value: "\"Username must have at least four characters.\""}
    - {propertyName: invalidCharsMessage, value: "\"Username cannot contain '#'.\""}
    rules:
    - {typeName: DefaultEmailByUsernameRule, existing: false}
    - {typeName: InvalidCharPreChangeRule}

  - typeName: EmailNode
    baseTypeName: StringUiNode
    properties:
    - {name: triggeredBy, typeName: String}
    init:
    - {propertyName: pattern, value: '"\\w+@\\w+\\.[\\w.]+"'}
    - {propertyName: patternMessage, value: '"Email format is invalid."'}
    - {propertyName: requiredMessage, value: '"Email is required."'}
    rules:
    - {typeName: EmailChangeReasonRule, existing: false}

  - typeName: PasswordNode
    baseTypeName: StringUiNode
    properties:
    - {name: message, typeName: String}
    rules:
    - {typeName: PasswordIsStrongRule, baseTypeName: ValidationRule, existing: false}

  - typeName: RepeatPasswordNode
    baseTypeName: StringUiNode
    rules:
    - {typeName: RepeatPasswordRule, baseTypeName: ValidationRule, existing: false}

  - typeName: AgeNode
    baseTypeName: BigDecimalUiNode
    init:
    - {propertyName: minValue, value: new BigDecimal("0")}
    - {propertyName: maxValue, value: new BigDecimal("120")}
    - {propertyName: rangeMessage, value: '"Age must be between 0 and 120."'}
    rules:
    - {typeName: UpdatePlanRule, existing: false}

  - typeName: PlanNode
    baseTypeName: StringUiNode
    init:
    - {propertyName: options, value: RegisterNodeConstants.PLANS}

  - typeName: ReceiveOffersNode
    baseTypeName: BooleanUiNode
    rules:
    - {typeName: EmailIsRequiredWhenReceiveOffersRule, existing: false}

  - typeName: OwnInvestmentPropertyNode
    baseTypeName: BooleanUiNode
    rules:
    - {typeName: LoadInvestmentPropertyRule, existing: false}

  - typeName: PropertyDetailsNode
    baseTypeName: ObjectUiNode
    unloadable: true
    properties:
    - {name: tooltip, typeName: String}
    children:
    - {typeName: PropertyAddressNode}
    - {typeName: PropertyStateNode}
    childTypes:
    - typeName: PropertyAddressNode
      baseTypeName: StringUiNode

    - typeName: PropertyStateNode
      baseTypeName: StringUiNode
      init:
      - {propertyName: required, value: 'true'}
      - {propertyName: requiredMessage, value: '"Property state is required."'}
      - {propertyName: options, value: RegisterNodeConstants.STATES}

  - typeName: PhoneInfoNode
    baseTypeName: ObjectUiNode
    children:
    - {typeName: CountryCodeNode}
    - {typeName: AreaCodeNode}
    - {typeName: PhoneNumberNode}
    rules:
    - {typeName: PhoneInfoAllOrNothingRule, existing: false}
    childTypes:
    - typeName: PhoneInfoFieldNode
      abstractNode: true
      baseTypeName: StringUiNode

    - typeName: CountryCodeNode
      baseTypeName: PhoneInfoFieldNode
      init:
      - {propertyName: requiredMessage, value: '"Country code is required."'}

    - typeName: AreaCodeNode
      baseTypeName: PhoneInfoFieldNode
      init:
      - {propertyName: requiredMessage, value: '"Area code is required."'}

    - typeName: PhoneNumberNode
      baseTypeName: PhoneInfoFieldNode
      init:
      - {propertyName: requiredMessage, value: '"Phone number is required."'}

  - typeName: ErrorListNode
    baseTypeName: ListUiNode
    itemTypeName: ErrorNode
    childTypes:
    - typeName: ErrorNode
      baseTypeName: ValidationErrorUiNode


